# Story 1.2: Mock Data System and Analytics Cards Implementation

## Status
Ready for Review

## Story
**As a** business owner monitoring incoming payments,  
**I want** a realistic mock data system with analytics cards displaying daily/weekly/monthly deposit metrics,  
**so that** I can validate the dashboard UI/UX and see meaningful financial insights before backend integration.

## Acceptance Criteria
1. Mock data generator creates realistic Colombian transaction data (names, amounts, timestamps)
2. Analytics cards display daily, weekly, monthly, and average deposit metrics
3. Mock data includes varied transaction patterns (different hours, days, amounts)
4. Zustand store manages transaction data and calculated metrics
5. Analytics cards update automatically when mock data changes
6. Data follows the Transaction and DashboardMetrics models from architecture
7. Mock system includes at least 100+ transactions spanning multiple weeks
8. Cards display proper Colombian Peso formatting and Colombian names

## Tasks / Subtasks
- [x] Create mock data generation system (AC: 1, 3, 7)
  - [x] Implement `src/lib/mock-data.ts` with transaction generator
  - [x] Create realistic Colombian names dataset
  - [x] Generate varied amounts ($50,000 - $2,000,000 COP range)
  - [x] Create varied time patterns (business hours focus, weekend variations)
  - [x] Generate 100+ transactions spanning 4+ weeks of data
- [x] Implement Zustand dashboard store (AC: 4, 5)
  - [x] Create `src/stores/dashboard.ts` with transaction state
  - [x] Add actions for adding transactions and updating metrics
  - [x] Implement metric calculations (daily, weekly, monthly totals)
  - [x] Add filtering and search state management
  - [x] Include loading and error state handling
- [x] Build analytics cards components (AC: 2, 8)
  - [x] Create `src/components/dashboard/MetricsCards.tsx` container
  - [x] Implement individual metric cards (Daily, Weekly, Monthly, Average)
  - [x] Add Colombian Peso currency formatting (e.g., "$190.000")
  - [x] Include percentage change indicators vs previous period
  - [x] Add proper shadcn/ui Card styling with green banking theme
- [x] Integrate mock data with dashboard store (AC: 5, 6)
  - [x] Initialize store with generated mock transactions
  - [x] Implement automatic metric recalculation on data changes
  - [x] Add mock real-time updates (new transaction every 30-60 seconds)
  - [x] Ensure proper TypeScript types match architecture models
- [x] Implement data models validation (AC: 6)
  - [x] Create TypeScript interfaces matching architecture specification
  - [x] Validate Transaction model fields (id, amount, senderName, etc.)
  - [x] Validate DashboardMetrics model (period, totalAmount, etc.)
  - [x] Add proper date handling with date-fns library
- [x] Add Colombian localization and formatting (AC: 8)
  - [x] Format currency as Colombian Pesos with proper separators
  - [x] Use Colombian naming patterns for mock sender names
  - [x] Implement proper date/time formatting for Colombian locale
  - [x] Add Colombian bank account number patterns (**7251 format)

## Dev Notes

### Architecture Context
**Source**: [docs/architecture.md]

### Data Models Implementation
Must implement exact TypeScript interfaces from architecture:

```typescript
interface Transaction {
  id: string;                    // UUID primary key
  amount: number;               // Numeric amount for calculations
  currency: string;             // "COP" for Colombian Peso
  senderName: string;          // Parsed sender name from SMS
  accountNumber: string;       // Last 4 digits (e.g., "**7251")
  date: Date;                  // Transaction date
  time: string;                // Transaction time (HH:mm format)
  rawMessage: string;          // Original SMS message (mock version)
  parsedAt: Date;              // When parsing occurred
  webhookId: string;           // Unique webhook identifier (mock)
  status: 'processed' | 'failed' | 'duplicate';
}

interface DashboardMetrics {
  period: 'daily' | 'weekly' | 'monthly';
  totalAmount: number;         // Sum of all amounts in period
  transactionCount: number;    // Count of transactions
  averageAmount: number;       // Average transaction amount
  periodStart: Date;           // Period start boundary
  periodEnd: Date;             // Period end boundary
  lastUpdated: Date;           // Cache invalidation timestamp
}
```

### Mock Data Requirements
**Colombian Context**: Use realistic Colombian names, amounts in COP, and banking patterns
- **Names**: Common Colombian names (María, Carlos, Ana, etc.)
- **Amounts**: Range $50,000 - $2,000,000 COP (typical transfer amounts)
- **Account Numbers**: **7251, **8934, **1234 format (last 4 digits)
- **Time Patterns**: Business hours (8AM-6PM) heavier, some evening/weekend
- **Geographic Distribution**: Include common Colombian cities in context

### Zustand Store Structure
```typescript
interface DashboardStore {
  // Data State
  transactions: Transaction[];
  metrics: Record<string, DashboardMetrics>;
  loading: boolean;
  error: string | null;
  
  // Filter State (for future stories)
  searchTerm: string;
  dateRange: { start: Date; end: Date };
  statusFilter: string;
  
  // Actions
  addTransaction: (transaction: Transaction) => void;
  updateMetrics: (period: string, metrics: DashboardMetrics) => void;
  setFilters: (filters: Partial<FilterState>) => void;
  clearError: () => void;
}
```

### Analytics Cards Specifications
**Design Requirements**:
- Use shadcn/ui Card components with banking green theme
- Display large metric numbers with proper Colombian formatting
- Include small percentage change indicators (+/-% vs previous period)
- Show period labels (Hoy, Esta Semana, Este Mes, Promedio)
- Responsive grid layout (2x2 on desktop, stacked on mobile)

**Card Types**:
1. **Daily Deposits**: Today's total amount and transaction count
2. **Weekly Deposits**: Current week total and count
3. **Monthly Deposits**: Current month total and count  
4. **Average Transaction**: Mean deposit amount across all data

### Performance Requirements
**From PRD**: Dashboard must load in < 2 seconds with mock data
- Mock data generation should be fast (< 100ms for 100+ records)
- Metric calculations should be efficient
- Store updates should not cause excessive re-renders
- Card animations should be smooth on mobile devices

### Component File Structure
```
src/components/dashboard/
├── MetricsCards.tsx       # Container component
├── MetricCard.tsx         # Individual card component
└── RealTimeIndicator.tsx  # For future real-time status
```

### Colombian Formatting Examples
- **Currency**: $190.000 (period as thousands separator)
- **Dates**: 04/09/2025 (DD/MM/YYYY format)
- **Names**: MARIA CUBAQUE, CARLOS RODRIGUEZ, ANA MARTINEZ
- **Accounts**: **7251, **8934, **1456

### Testing Standards

#### Testing Requirements for This Story
- **Unit Tests**: Mock data generator functions
- **Component Tests**: Analytics cards render with proper data
- **Store Tests**: Zustand actions and state updates
- **Integration Tests**: Mock data → Store → UI flow
- **Performance Tests**: Load time with 100+ mock transactions

#### Test Scenarios
1. Mock data generates valid Transaction objects
2. Analytics cards display correct calculations
3. Currency formatting shows Colombian Peso format
4. Store updates trigger proper UI re-renders
5. Metric calculations handle edge cases (no data, single transaction)

#### Test File Locations
- `src/lib/__tests__/mock-data.test.ts`
- `src/stores/__tests__/dashboard.test.ts`
- `src/components/dashboard/__tests__/MetricsCards.test.tsx`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-05 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References  
- All mock data generation validated successfully
- TypeScript compilation passed without errors
- ESLint validation passed without errors
- Build completed successfully with static optimization

### Completion Notes List
- ✅ Mock data system generates 100+ transactions with Colombian patterns
- ✅ Zustand store manages transactions and calculates metrics automatically
- ✅ Analytics cards display proper Colombian currency formatting ($190.000)
- ✅ Real-time simulation adds new transactions every 30-60 seconds
- ✅ All data models match architecture specification exactly
- ✅ Comprehensive validation ensures data integrity
- ✅ Colombian localization implemented throughout
- ✅ Performance requirements met (< 2 second load time)
- ✅ All acceptance criteria successfully implemented

### File List
**New Files Created:**
- `src/lib/mock-data.ts` - Mock data generation with Colombian patterns
- `src/components/dashboard/MetricsCards.tsx` - Analytics cards component
- `src/hooks/useMockDataLoader.ts` - Data loading and real-time simulation hook
- `src/lib/colombian-formatting.ts` - Colombian localization utilities
- `src/lib/validation.ts` - Data validation and integrity checks
- `src/lib/__tests__/mock-data.test.ts` - Unit tests for mock data system
- `src/stores/__tests__/dashboard.test.ts` - Store tests

**Modified Files:**
- `src/lib/types.ts` - Updated interfaces to match architecture specification
- `src/stores/dashboard.ts` - Enhanced store with metric calculations
- `src/components/dashboard/dashboard-layout.tsx` - Integrated new components

## QA Results
*To be populated by QA agent*